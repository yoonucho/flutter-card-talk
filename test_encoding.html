<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Base64 URL ì¸ì½”ë”©/ë””ì½”ë”© í…ŒìŠ¤íŠ¸</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 20px;
      }
      .container {
        max-width: 800px;
        margin: 0 auto;
      }
      textarea {
        width: 100%;
        height: 100px;
        margin-bottom: 10px;
      }
      button {
        padding: 8px 16px;
        margin-right: 10px;
      }
      .result {
        margin-top: 20px;
        padding: 10px;
        background: #f5f5f5;
        border-radius: 4px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>Base64 URL ì¸ì½”ë”©/ë””ì½”ë”© í…ŒìŠ¤íŠ¸</h1>

      <h2>1. ì›ë³¸ JSON ë°ì´í„°</h2>
      <textarea id="jsonInput">
{"name":"í…ŒìŠ¤íŠ¸ ì¹´ë“œ","emoji":"ğŸ’Œ","message":"ì•ˆë…•í•˜ì„¸ìš”! í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€ì…ë‹ˆë‹¤.","backgroundColor":"#fce4ec","textColor":"#c2185b"}</textarea
      >

      <h2>2. Base64 ì¸ì½”ë”©</h2>
      <button onclick="encodeBase64()">Base64 ì¸ì½”ë”©</button>
      <div class="result" id="base64Result"></div>

      <h2>3. URL ì•ˆì „ ì¸ì½”ë”©</h2>
      <button onclick="makeUrlSafe()">URL ì•ˆì „í•˜ê²Œ ë³€í™˜</button>
      <div class="result" id="urlSafeResult"></div>

      <h2>4. URL ë””ì½”ë”©</h2>
      <textarea id="urlInput"></textarea>
      <button onclick="decodeUrl()">URL ë””ì½”ë”©</button>
      <div class="result" id="urlDecodedResult"></div>

      <h2>5. Base64 ë””ì½”ë”©</h2>
      <button onclick="decodeBase64()">Base64 ë””ì½”ë”©</button>
      <div class="result" id="decodedResult"></div>
    </div>

    <script>
      // Base64 ì¸ì½”ë”©
      function encodeBase64() {
        const jsonData = document.getElementById("jsonInput").value;
        const encoded = btoa(jsonData);
        document.getElementById("base64Result").textContent = encoded;
        return encoded;
      }

      // URL ì•ˆì „í•˜ê²Œ ë³€í™˜
      function makeUrlSafe() {
        const base64 =
          document.getElementById("base64Result").textContent || encodeBase64();
        // 1. Flutter ë°©ì‹ (replaceAll)
        // const urlSafe = base64.replace(/\+/g, '-').replace(/\//g, '_').replace(/=/g, '');

        // 2. encodeURIComponent ë°©ì‹
        const urlSafe = encodeURIComponent(base64);

        document.getElementById("urlSafeResult").textContent = urlSafe;
        document.getElementById("urlInput").value = urlSafe;
        return urlSafe;
      }

      // URL ë””ì½”ë”©
      function decodeUrl() {
        const urlData = document.getElementById("urlInput").value;
        try {
          const decoded = decodeURIComponent(urlData);
          document.getElementById("urlDecodedResult").textContent = decoded;
          return decoded;
        } catch (e) {
          document.getElementById("urlDecodedResult").textContent =
            "ì˜¤ë¥˜: " + e.message;
          return null;
        }
      }

      // Base64 ë””ì½”ë”©
      function decodeBase64() {
        const urlDecoded =
          document.getElementById("urlDecodedResult").textContent ||
          decodeUrl();
        if (!urlDecoded || urlDecoded.startsWith("ì˜¤ë¥˜")) return;

        try {
          // URL ì•ˆì „ Base64ë¥¼ í‘œì¤€ Base64ë¡œ ë³€í™˜
          let base64Data = urlDecoded.replace(/-/g, "+").replace(/_/g, "/");
          // íŒ¨ë”© ì¶”ê°€
          while (base64Data.length % 4) {
            base64Data += "=";
          }

          const jsonData = atob(base64Data);
          document.getElementById("decodedResult").textContent = jsonData;

          // JSON íŒŒì‹± í…ŒìŠ¤íŠ¸
          const parsedData = JSON.parse(jsonData);
          console.log("JSON íŒŒì‹± ì„±ê³µ:", parsedData);
        } catch (e) {
          document.getElementById("decodedResult").textContent =
            "ì˜¤ë¥˜: " + e.message;
        }
      }
    </script>
  </body>
</html>
